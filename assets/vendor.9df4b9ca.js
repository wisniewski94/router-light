var M=Object.defineProperty,T=Object.defineProperties;var U=Object.getOwnPropertyDescriptors;var L=Object.getOwnPropertySymbols;var W=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable;var A=(r,t,e)=>t in r?M(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,P=(r,t)=>{for(var e in t||(t={}))W.call(t,e)&&A(r,e,t[e]);if(L)for(var e of L(t))$.call(t,e)&&A(r,e,t[e]);return r},y=(r,t)=>T(r,U(t));var O=(r,t,e)=>{if(!t.has(r))throw TypeError("Cannot "+e)};var h=(r,t,e)=>(O(r,t,"read from private field"),e?e.call(r):t.get(r)),a=(r,t,e)=>{if(t.has(r))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(r):t.set(r,e)},D=(r,t,e,s)=>(O(r,t,"write to private field"),s?s.call(r,e):t.set(r,e),e);var n=(r,t,e)=>(O(r,t,"access private method"),e);var i,g,f,H,d,S,p,I,w,j,m,z,x,B,E,C,k,N,b,q,l,v,R,F;class J{constructor(){a(this,f);a(this,d);a(this,p);a(this,w);a(this,m);a(this,x);a(this,E);a(this,k);a(this,b);a(this,l);a(this,R);a(this,i,{});a(this,g,null);n(this,R,F).call(this)}get(t,e){const s=h(this,i);return s[t]||(s[t]={},s[t].callbacks=[]),s[t].reg=n(this,m,z).call(this,t),s[t].callbacks.push(e),!0}}i=new WeakMap,g=new WeakMap,f=new WeakSet,H=function(t){t==="/404"?window.history.replaceState(null,null,t):window.history.pushState(null,null,t),n(this,l,v).call(this,t)},d=new WeakSet,S=function(){console.error("Page not found"),n(this,f,H).call(this,"/404")},p=new WeakSet,I=function(t){try{return Object.keys(t).filter(e=>Number(e)).reduce((e,s)=>y(P({},e),{[s]:t[s]}),{})}catch{return n(this,d,S).call(this),{}}},w=new WeakSet,j=function(t,e){let s=-1;return Object.entries(t).reduce((c,u,o)=>(t[o+1]==="*"&&(s+=1),y(P({},c),{[t[o+1]==="*"?s:t[o+1].substring(1)]:e[o+1]})),{})},m=new WeakSet,z=function(t){return`^${t.replace(/\\/g,"\\/").replace(/(\*|:\w*)/gm,"(:?[A-z0-9|*]*)")}(?:\\/?)$`},x=new WeakSet,B=function(t){return e=>{const s=h(this,i)[e].reg;return!!new RegExp(s,"i").exec(t)}},E=new WeakSet,C=function(t){const s=/^#/.test(t);return Boolean(s)},k=new WeakSet,N=function(t,e){const s=h(this,i)[t].reg,c=new RegExp(s,"i"),u=n(this,p,I).call(this,c.exec(t)),o=n(this,p,I).call(this,c.exec(e));return n(this,w,j).call(this,u,o)},b=new WeakSet,q=function(t,e){D(this,g,e);const s=n(this,k,N).call(this,t,e);return h(this,i)[t].callbacks.forEach(c=>c(s))},l=new WeakSet,v=function(t){const s=/#\S+\b/gm.exec(t),c=s?t.replace(s[0],""):t,u=Object.keys(h(this,i)).find(n(this,x,B).call(this,c));return u?h(this,g)===c?!1:(n(this,b,q).call(this,u,c),!0):(n(this,d,S).call(this),!1)},R=new WeakSet,F=function(){this.get("/",()=>{}),this.get("/404",()=>{}),document.addEventListener("click",t=>{const e=t.target.closest("a");if(!e)return;const s=e.getAttribute("href");n(this,E,C).call(this,s)||e.hostname===location.hostname&&(t.preventDefault(),n(this,f,H).call(this,s))},!1),window.addEventListener("DOMContentLoaded",t=>{t.preventDefault(),n(this,l,v).call(this,location.pathname+location.hash)}),window.addEventListener("popstate",()=>{n(this,l,v).call(this,location.pathname+location.hash)})};export{J as R};
